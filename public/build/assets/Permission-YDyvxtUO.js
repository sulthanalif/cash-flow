import{d as D,A as M,z as c,c as F,w as i,a as t,u as o,f as d,e as l,t as w,B,b as V,o as b,y as T,j as P,g as A,k as U,C as j,F as L}from"./app-CWJbBq8d.js";import{a as O,b as R,c as q,d as z,e as K,t as $,_ as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-CkwwiSMc.js";import{T as G,_ as H,a as I}from"./AlertDialog.vue_vue_type_script_setup_true_lang-B1nFD1ze.js";import{_ as S}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-jZSWENVw.js";import{_ as J}from"./InputError.vue_vue_type_script_setup_true_lang-CgwJszMy.js";import{_ as Q}from"./Input.vue_vue_type_script_setup_true_lang-DkS3R-gs.js";import{_ as W}from"./Label.vue_vue_type_script_setup_true_lang-C9w5Mgsp.js";import{_ as X,P as Z}from"./SheetFooter.vue_vue_type_script_setup_true_lang-Cuf_f0gr.js";import{_ as ee}from"./Spinner.vue_vue_type_script_setup_true_lang-CSN6QzZF.js";import"./index-DW5GjqPz.js";import"./VisuallyHidden-BXyloCnx.js";import"./useForwardExpose-C3AL2TOg.js";import"./useForwardPropsEmits-BnKj6mOh.js";import"./loader-circle-CqmDDe9e.js";import"./index-C4J_hXM0.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-h3fJgLfG.js";import"./VisuallyHiddenInput-BrzrrAsq.js";import"./check-D64bzGvy.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-DHWBxg29.js";import"./chevron-left-BGh65DUP.js";const se={class:"flex-1 overflow-y-auto px-6 py-6"},te={class:"grid gap-2"},oe=D({__name:"PermissionForm",setup(k,{expose:h}){const e=M({id:0,name:""}),m=c(!1),_=c(""),v=c(""),p=c(!1),g=()=>{p.value=!0;const u=e.id?route("permissions.update",e.id):route("permissions.store"),s=e.id?"put":"post";e[s](u,{preserveScroll:!0,onSuccess:()=>{$.success(e.id?"Update Permission Success":"Create Permission Success"),e.reset(),e.clearErrors(),r()},onError:n=>{n.message&&!Object.keys(n).some(C=>C!=="message")&&$.error(n.message)},onFinish:()=>{p.value=!1}})},r=()=>{m.value=!1,setTimeout(()=>{e.reset(),e.clearErrors()},300)};return h({openCreateModal:()=>{e.reset(),e.clearErrors(),e.id=0,_.value="Create Permission",v.value="Add a new permission to the system.",m.value=!0},openEditModal:u=>{e.clearErrors(),e.id=u.id,e.name=u.name,_.value="Edit Permission",v.value="Modify the permission name.",m.value=!0}}),(u,s)=>(b(),F(o(K),{open:m.value,"onUpdate:open":s[1]||(s[1]=n=>m.value=n)},{default:i(()=>[t(o(O),{class:"flex h-full w-full flex-col gap-0 p-0 sm:max-w-md"},{default:i(()=>[t(o(R),{class:"border-b px-6 py-6"},{default:i(()=>[t(o(q),null,{default:i(()=>[l(w(_.value),1)]),_:1}),t(o(z),null,{default:i(()=>[l(w(v.value),1)]),_:1})]),_:1}),d("div",se,[d("form",{id:"permissionForm",onSubmit:B(g,["prevent"]),class:"flex flex-col gap-6"},[d("div",te,[t(W,{for:"name",class:"font-semibold"},{default:i(()=>[...s[2]||(s[2]=[l("Permission Name",-1)])]),_:1}),t(Q,{id:"name",type:"text",required:"",autofocus:"",placeholder:"e.g. user-create",modelValue:o(e).name,"onUpdate:modelValue":s[0]||(s[0]=n=>o(e).name=n)},null,8,["modelValue"]),t(J,{message:o(e).errors.name},null,8,["message"]),s[3]||(s[3]=d("p",{class:"text-[0.8rem] text-muted-foreground"},[l(" Use a convention like "),d("code",null,"resource-action"),l(" (e.g., post-edit). ")],-1))])],32)]),t(o(X),{class:"mt-auto px-6 py-4 sm:justify-between dark:bg-transparent"},{default:i(()=>[t(o(S),{type:"submit",form:"permissionForm",disabled:p.value},{default:i(()=>[p.value?(b(),F(ee,{key:0,class:"animate-spin"})):V("",!0),s[4]||(s[4]=l(" Save ",-1))]),_:1},8,["disabled"]),t(o(S),{type:"button",variant:"ghost",onClick:r},{default:i(()=>[...s[5]||(s[5]=[l(" Cancel ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}}),ae={class:"flex h-full flex-1 flex-col gap-4 p-4"},ie={class:"flex justify-end items-center gap-2"},ne={key:0},Ee=D({__name:"Permission",props:{permissions:{}},setup(k){const e=T().props.auth.permissions,m=P(()=>Array.isArray(e)&&e.includes("permission-create")),_=P(()=>Array.isArray(e)&&e.includes("permission-edit")),v=P(()=>Array.isArray(e)&&e.includes("permission-delete")),p=k,g=c(null),r=M({id:0,name:""}),y=c(!1),x=c(!1),u=a=>{r.id=a.id,r.name=a.name,y.value=!0},s=()=>{x.value=!0,r.delete(route("permissions.destroy",r.id),{preserveScroll:!0,onSuccess:()=>{$.success("Delete Permission Success"),y.value=!1},onError:a=>{a.message&&$.error(a.message)},onFinish:()=>{x.value=!1}})},n=[{accessorKey:"name",header:"Name",cell:({row:a})=>j("div",{class:"font-medium"},a.getValue("name"))}],C=[..._.value?[{label:"Edit Permission",icon:Z,onClick:a=>g.value?.openEditModal(a)}]:[],...v.value?[{label:"Delete Permission",icon:G,class:"text-red-600 focus:text-red-600",onClick:a=>u(a)}]:[]],N=[{title:"Permissions",href:"/permissions"}];return(a,f)=>(b(),A(L,null,[t(o(U),{title:"Permissions"}),t(Y,{breadcrumbs:N},{default:i(()=>[d("div",ae,[d("div",ie,[m.value?(b(),A("div",ne,[t(o(S),{class:"w-32",onClick:f[0]||(f[0]=E=>g.value?.openCreateModal())},{default:i(()=>[...f[2]||(f[2]=[l(" Create ",-1)])]),_:1})])):V("",!0)]),t(H,{data:p.permissions,columns:n,actions:!0,"action-list":C},null,8,["data"])]),t(oe,{ref_key:"permissionFormRef",ref:g},null,512),t(I,{open:y.value,"onUpdate:open":f[1]||(f[1]=E=>y.value=E),title:"Delete Permission?",description:`Are you sure you want to delete the permission '${o(r).name}'? This cannot be undone.`,"confirm-text":"Yes, Delete","cancel-text":"Cancel",variant:"destructive","is-loading":x.value,onConfirm:s},null,8,["open","description","is-loading"])]),_:1})],64))}});export{Ee as default};
