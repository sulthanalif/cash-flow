import{d as B,A as P,z as f,c as O,w as r,a as o,u as a,f as p,e as i,t as j,B as q,g as A,b as D,o as b,y as L,j as U,k as R,C,F as K}from"./app-j-64a5Ha.js";import{a as z,b as J,c as Y,d as G,e as H,t as k,_ as I}from"./AppLayout.vue_vue_type_script_setup_true_lang-BHsSbUHQ.js";import{T as Q,_ as W,a as X}from"./AlertDialog.vue_vue_type_script_setup_true_lang-D2zn_A3i.js";import{_ as N}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Chx8RZ2w.js";import{_ as Z}from"./index-DWS6Rvp6.js";import{_ as ee,P as se}from"./SheetFooter.vue_vue_type_script_setup_true_lang-CXS4R0ej.js";import{_ as F}from"./Input.vue_vue_type_script_setup_true_lang-CvFFM94x.js";import{_ as V}from"./Label.vue_vue_type_script_setup_true_lang-D1FaYsk7.js";import{_ as h}from"./InputError.vue_vue_type_script_setup_true_lang-5lcgcq8K.js";import{_ as ae}from"./ComboBox.vue_vue_type_script_setup_true_lang-CU9_tGvM.js";import{_ as oe}from"./Spinner.vue_vue_type_script_setup_true_lang-BYi9uNFq.js";import"./index-BHdgmjdU.js";import"./VisuallyHidden-DLyNnu_T.js";import"./useForwardExpose-DYQEBLxO.js";import"./useForwardPropsEmits-DKoSHOgQ.js";import"./loader-circle-CcxE_MHQ.js";import"./index-C4J_hXM0.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-l0iint1Q.js";import"./VisuallyHiddenInput-CfcJsvgy.js";import"./check-agNWRqK3.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-Cw0zBLRN.js";import"./chevron-left-CedEaYZ_.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-By5hQKLY.js";const le={class:"flex-1 overflow-y-auto px-6 py-6"},te={class:"grid gap-2"},re={class:"grid gap-2"},ne={class:"grid gap-2"},ie={class:"grid gap-2"},de={key:0,class:"text-xs font-normal text-muted-foreground ml-1"},me=B({__name:"UserForm",props:{roleOptions:{}},setup(S,{expose:M}){const d=S,e=P({id:0,name:"",email:"",password:"",role:""}),c=f(!1),g=f(""),_=f(""),v=f(!1),y=()=>{v.value=!0;const n=e.id?route("users.update",e.id):route("users.store"),s=e.id?"put":"post";e[s](n,{preserveScroll:!0,onSuccess:()=>{k.success(e.id?"Update User Success":"Create User Success"),e.reset(),e.clearErrors(),m()},onError:t=>{t.message&&!Object.keys(t).some(E=>E!=="message")&&k.error(t.message)},onFinish:()=>{v.value=!1}})},m=()=>{c.value=!1,setTimeout(()=>{e.reset(),e.clearErrors()},300)};return M({openCreateModal:()=>{e.reset(),e.clearErrors(),e.id=0,g.value="Create New User",_.value="Add a new user to the system and assign a role.",c.value=!0},openEditModal:n=>{e.clearErrors(),e.id=n.id,e.name=n.name,e.email=n.email,e.password="",e.role=n.roles.length>0?n.roles[0].name:"",g.value="Edit User",_.value="Update user details and access level.",c.value=!0}}),(n,s)=>(b(),O(a(H),{open:c.value,"onUpdate:open":s[4]||(s[4]=t=>c.value=t)},{default:r(()=>[o(a(z),{class:"w-full sm:max-w-md h-full flex flex-col p-0 gap-0"},{default:r(()=>[o(a(J),{class:"px-6 py-6 border-b"},{default:r(()=>[o(a(Y),null,{default:r(()=>[i(j(g.value),1)]),_:1}),o(a(G),null,{default:r(()=>[i(j(_.value),1)]),_:1})]),_:1}),p("div",le,[p("form",{id:"userForm",onSubmit:q(y,["prevent"]),class:"flex flex-col gap-6"},[p("div",te,[o(V,{for:"name",class:"font-semibold"},{default:r(()=>[...s[5]||(s[5]=[i("Full Name",-1)])]),_:1}),o(F,{id:"name",type:"text",required:"",autofocus:"",placeholder:"e.g. John Doe",modelValue:a(e).name,"onUpdate:modelValue":s[0]||(s[0]=t=>a(e).name=t)},null,8,["modelValue"]),o(h,{message:a(e).errors.name},null,8,["message"])]),p("div",re,[o(V,{for:"email",class:"font-semibold"},{default:r(()=>[...s[6]||(s[6]=[i("Email Address",-1)])]),_:1}),o(F,{id:"email",type:"email",required:"",placeholder:"john@example.com",modelValue:a(e).email,"onUpdate:modelValue":s[1]||(s[1]=t=>a(e).email=t)},null,8,["modelValue"]),o(h,{message:a(e).errors.email},null,8,["message"])]),p("div",ne,[o(V,{for:"roles",class:"font-semibold"},{default:r(()=>[...s[7]||(s[7]=[i("Role",-1)])]),_:1}),o(ae,{modelValue:a(e).role,"onUpdate:modelValue":s[2]||(s[2]=t=>a(e).role=t),options:d.roleOptions,placeholder:"Select a role...","search-placeholder":"Search role...","empty-text":"No role found."},null,8,["modelValue","options"]),o(h,{message:a(e).errors.role},null,8,["message"])]),p("div",ie,[o(V,{for:"password",class:"font-semibold"},{default:r(()=>[s[8]||(s[8]=i(" Password ",-1)),a(e).id?(b(),A("span",de,"(Leave blank to keep current)")):D("",!0)]),_:1}),o(F,{id:"password",type:"password",required:!a(e).id,placeholder:"••••••••",modelValue:a(e).password,"onUpdate:modelValue":s[3]||(s[3]=t=>a(e).password=t)},null,8,["required","modelValue"]),o(h,{message:a(e).errors.password},null,8,["message"])])],32)]),o(a(ee),{class:"mt-auto px-6 py-4 sm:justify-between dark:bg-transparent"},{default:r(()=>[o(a(N),{type:"submit",form:"userForm",disabled:v.value},{default:r(()=>[v.value?(b(),O(oe,{key:0,class:"animate-spin"})):D("",!0),s[9]||(s[9]=i(" Save ",-1))]),_:1},8,["disabled"]),o(a(N),{type:"button",variant:"ghost",onClick:m},{default:r(()=>[...s[10]||(s[10]=[i(" Cancel ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}}),ue={class:"flex h-full flex-1 flex-col gap-4 p-4"},pe={class:"flex justify-end items-center gap-2"},ce={key:0},Be=B({__name:"User",props:{users:{},roles:{}},setup(S){const d=L().props.auth.permissions,e=U(()=>Array.isArray(d)&&d.includes("user-create")),c=U(()=>Array.isArray(d)&&d.includes("user-edit")),g=U(()=>Array.isArray(d)&&d.includes("user-delete")),_=S,v=U(()=>_.roles.map(l=>({value:l.name,label:l.name}))),y=f(null),m=P({id:0,name:""}),x=f(!1),$=f(!1),n=l=>{m.id=l.id,m.name=l.name,x.value=!0},s=()=>{$.value=!0,m.delete(route("users.destroy",m.id),{preserveScroll:!0,onSuccess:()=>{k.success("User deleted successfully"),x.value=!1},onError:l=>{l.message&&k.error(l.message)},onFinish:()=>{$.value=!1}})},t=[{accessorKey:"name",header:"Name",cell:({row:l})=>C("div",{class:"font-medium"},l.getValue("name"))},{accessorKey:"email",header:"Email",cell:({row:l})=>C("div",l.getValue("email"))},{accessorKey:"roles",header:"Roles",cell:({row:l})=>{const u=l.original.roles;return C("div",{class:"flex flex-wrap gap-1"},u.map(w=>C(Z,{variant:"outline"},()=>w.name)))}}],E=[...c.value?[{label:"Edit User",icon:se,onClick:l=>y.value?.openEditModal(l)}]:[],...g.value?[{label:"Delete User",icon:Q,class:"text-red-600 focus:text-red-600",onClick:l=>n(l)}]:[]],T=[{title:"Users",href:"/users"}];return(l,u)=>(b(),A(K,null,[o(a(R),{title:"Users"}),o(I,{breadcrumbs:T},{default:r(()=>[p("div",ue,[p("div",pe,[e.value?(b(),A("div",ce,[o(a(N),{class:"w-32",onClick:u[0]||(u[0]=w=>y.value?.openCreateModal())},{default:r(()=>[...u[2]||(u[2]=[i(" Create ",-1)])]),_:1})])):D("",!0)]),o(W,{data:_.users,columns:t,actions:!0,"action-list":E},null,8,["data"])]),o(me,{ref_key:"userFormRef",ref:y,"role-options":v.value},null,8,["role-options"]),o(X,{open:x.value,"onUpdate:open":u[1]||(u[1]=w=>x.value=w),title:"Delete User?",description:`Are you sure you want to delete user ${a(m).name}? This action cannot be undone.`,"confirm-text":"Yes, Delete","cancel-text":"Cancel",variant:"destructive","is-loading":$.value,onConfirm:s},null,8,["open","description","is-loading"])]),_:1})],64))}});export{Be as default};
